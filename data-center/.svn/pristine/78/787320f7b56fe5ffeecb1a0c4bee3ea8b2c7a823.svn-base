/*! taomee tongji javascript code by maverick 2015-02-04 */
!function(){function a(){var a='<ul><li class="widget-sel"><label class="title-inline">'+lang.t("旧密码：")+'</label><input type="password" name="old_pwd" class="ipttxt"><i class="icon">&nbsp;</i></li><li class="widget-sel"><label class="title-inline">'+lang.t("新密码：")+'</label><input type="password" name="new_pwd" class="ipttxt"><i class="icon">&nbsp;</i></li><li class="widget-sel"><label class="title-inline">'+lang.t("确认密码：")+'</label><input type="password" name="confirm_pwd" class="ipttxt"><i class="icon">&nbsp;</i></li></ul>',c=function(a){var b=a.parent().find(".icon");a.val()?b.removeClass("error").addClass("ok"):b.removeClass("ok").addClass("error")};b&&($(b.getMask()).remove(),$(b.getContainer()).remove()),b=$.Dlg.Util.popup({id:"J_updPass",title:lang.t("修改密码"),contentHtml:a,callback:function(a){var b=a.find("[name=old_pwd]"),d=a.find("[name=new_pwd]"),e=a.find("[name=confirm_pwd]");b.blur(function(){c($(this))}),d.blur(function(){c($(this))}),e.blur(function(){var a=$(this).parent().find(".icon");$(this).val()&&$(this).val()==d.val()?a.removeClass("error").addClass("ok"):a.removeClass("ok").addClass("error")})},saveCallback:function(){var a=$("#J_updPass"),b=!0;return a.find(".icon").each(function(){$(this).parent().find("input").blur(),$(this).hasClass("ok")||(b=!1)}),b&&ajax(getUrl("user","changePassword"),{old_pwd:a.find("input[name=old_pwd]").val(),new_pwd:a.find("input[name=new_pwd]").val()},function(a){0==a.result?location.reload():say(lang.t("修改失败：")+a.err_desc)}),b}}),b.show()}var b;$(function(){$("#J_passwd").click(function(){a()});var b=$("body").find(".need-new");b.length&&b.each(function(){$(this).wrap('<div class="tools-new"></div>')}),$(window).bind("beforeunload",function(){window.gLoading.cancel()}),$("[data-stat]").on("mousedown",function(){msglog($(this).attr("data-stat"),$(this).attr("data-stat-item"))}),$(".tips a.tips-close").click(function(){$(this).parent().remove()}),$(".J-coming-soon").add(".J-new-function").each(function(){var a=lang.t("敬请期待");$(this).hasClass("J-new-function")&&(a=""),function(a,b){var c=$(document.createElement("d")).addClass("hint").text(b).appendTo(a);$("body").width()-a.offset().left-a.width()>75?c.addClass("hint-right").css({top:Math.ceil((a.height()-27)/2)}):c.addClass("hint-left").css({top:Math.ceil((a.height()-27)/2)})}($(this),a)})}),window.msglog=function(a,b,c){responseData.isRelease&&$.ajax({url:"//newmisc.taomee.com/misc.js?gameid=10000&uid="+responseData.userId+"&stid="+a+"&sstid="+b+("undefined"==typeof c?"":"&item="+c),dataType:"jsonp"})},function(){msglog("登入","用户登入"),msglog("页面数据",$("#J_header .main-nav li.cur").text()),msglog("登录用户详情",responseData.userName)}()}();