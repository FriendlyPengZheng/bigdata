/*! taomee tongji javascript code by maverick 2015-02-04 */
function ajaxData(a,b,c,d){d&&overlayer({text:lang.t("操作中...")}),ajax(a,b,function(a){0==a.result?(d&&hidelayer(lang.t("操作成功~.~")),c&&c(a.data)):(d&&hidelayer(),say(lang.t("获取数据错误：")+a.err_desc))},"POST")}!function(a,b){function c(){var a="";a+='<div class="widget-sel"><span class="note"><span class="c-red">'+lang.t("注：")+"</span>"+lang.t("只能添加到{1}类型的小部件中，且最多可添加{2}条数据哦。",'<span class="c-red">'+lang.t("表格")+"</span>",'<span class="c-red">1000</span>')+'</span></div><div class="widget-sel" id="J_type"><span class="sel-title">'+lang.t("我的收藏类型：")+'</span><label class="mr10"><input type="radio" name="type" value="1" checked>'+lang.t("单项目")+'</label><label class="mr10"><input type="radio" name="type" value="2">'+lang.t("多项目")+'</label></div><div class="widget-sel" id="J_homePlat" style="display:none;"><span class="sel-title">'+lang.t("选择平台区服：")+'</span><div class="sel-wrapper"></div><a href="javascript:void(0);" class="add-m">Add</a></div><div class="widget-sel" id="J_favor"><span class="sel-title">'+lang.t("我的收藏：")+'</span> <a class="add-m" href="javascript:void(0);">'+lang.t("新建")+'</a><div class="sel-wrapper"></div></div><div class="widget-sel" id="J_collect"><span class="sel-title">'+lang.t("窗口小部件：")+'</span> <a class="add-m" href="javascript:void(0);">'+lang.t("新建")+'</a><div class="sel-wrapper"></div>',F.widget=$.Dlg.Util.popup({id:"J_widget",title:lang.t("添加到我的收藏"),width:"600px",contentHtml:a,saveCallback:function(){d()},callback:function(){}});var b=$("#J_homePlat"),c=$("#J_favor"),e=$("#J_collect");$("#J_addFavorBtn").click(function(a){a.stopPropagation();var b=$("#J_content").find("table").find(".tbl-ckb:checked"),c=b.length;$("#J_widget").data("len",c),f(),j(),k(-1),F.widget.show()}).hide(),b.find(".add-m").click(function(a){a.stopPropagation(),f()}),c.find(".add-m").click(function(a){a.stopPropagation();var b=$(a.target),d=c.find(".sel-wrapper"),f=c.find(".sel-con"),g=(f.length,d.find(".popup-txt"));b.hasClass("clicked")?(b.removeClass("clicked"),g.hide(),f.show()):(b.addClass("clicked"),f.hide(),0==g.length?$(document.createElement("input")).attr({type:"text"}).val(lang.t("未命名我的收藏")).addClass("popup-txt").appendTo(d):g.show(),e.find(".add-m").click())}),e.find(".add-m").click(function(a){a.stopPropagation();var b=$(a.target),d=e.find(".sel-wrapper"),f=e.find(".sel-con"),g=(f.length,d.find(".popup-txt"));b.hasClass("clicked")&&!c.find(".sel-wrapper .popup-txt").is(":visible")?(b.removeClass("clicked"),g.hide(),f.show()):(b.addClass("clicked"),f.hide(),0!=g.length?g.show():$(document.createElement("input")).attr({type:"text"}).val(lang.t("未命名窗口小部件")).addClass("popup-txt").appendTo(d))}),$("#J_type").find("input[name='type']").click(function(a){a.stopPropagation(),2==$(this).val()?b.show():b.hide(),j(),k()})}function d(){var a=e(),b=function(){ajaxData(getUrl("home","collect",a.a),a,function(){say(lang.t("保存成功！"),!0),F.widget.fadeOut()})};a&&(a.favor_id?b(a):ajaxData(getUrl("home","favor","add"),{layout:1,favor_name:a.favor_name,favor_type:a.favor_type,game_id:a.game_id?a.game_id:0},function(c){a.favor_id=c,b(a)}))}function e(){var a=$("#J_content").find("table").find(".favor-checked"),b=$("#J_widget"),c=$("#J_favor"),d=$("#J_collect"),e=c.find(".add-m"),f=d.find(".add-m"),g=$("#J_type").find("input[name='type']:checked").val(),h={draw_type:3,favor_type:g,indicator:[]};if(1==g){if(h.game_id=$("#J_paramGameId").val(),a.length>1e3)return b.find(".note").hint(),null}else{var i=$("#J_homePlat"),j=i.find(".act-li"),k=[];if(!j.length)return i.hint(),null;if(j.each(function(){k.push($(this).attr("data-id"))}),k.length*a.length>1e3)return b.find(".note").hint(),null}if(e.hasClass("clicked")){var l=c.find(".sel-wrapper .popup-txt");if(!l.val())return l.hint(),null;h.favor_name=l.val()}else{var m=c.find(".sel-wrapper").find(".select-m");if(!m.hasClass("selected-m"))return m.hint(),null;h.favor_id=m.find(".title-m .t-name").attr("data-id")}if(f.hasClass("clicked")){var n=d.find(".sel-wrapper .popup-txt");if(!n.val())return n.hint(),null;h.collect_name=n.val(),h.a="add"}else{var o=d.find(".sel-wrapper").find(".select-m");if(!o.hasClass("selected-m"))return o.hint(),null;h.collect_id=o.find(".title-m .t-name").attr("data-id"),h.a="append"}if($("#J_singleReport").find("table").find(".favor-checked").each(function(){var a=$(this).attr("value").split("_");h.indicator.push({type:a[0],id:a[1],settings:[]})}),$("#J_multiReport").find("table").find(".favor-checked").each(function(){var a=$("#J_multiReport").find(".tabs-active").attr("data-id").split("_"),b={type:a[0],id:a[1],settings:[]};b.settings.push($(this).attr("value")),h.indicator.push(b)}),2==g){var p=[];j.each(function(){var a=$(this).attr("data-id");$.each(h.indicator,function(){p.push({type:this.type,id:this.id,settings:this.settings,gpzs_id:a})})}),h.indicator=p}return h}function f(){var a=$("#J_homePlat"),b=a.find(".sel-wrapper"),c=$(document.createElement("div")).addClass("sel-con").css({position:"relative","z-index":m()}),d=$(document.createElement("div")).addClass("sel-p"),e=a.data("platform"),f=(a.find(".add-m"),{search:!0,type:2,page:2,obj:d,mulRadio:1,callback:function(a,c){i(b,a,c)},getData:function(a,b){ajaxData(getUrl("common","gpzs","getZoneServer"),{game_id:$("#J_paramGameId").val(),platform_id:a},function(a){a=h(a),b&&b(a)})}});e?(f.data=e,$.choose.core(f)):ajaxData(getUrl("common","gpzs","getPlatform"),{game_id:$("#J_paramGameId").val()},function(b){b=g(b),a.data("platform",b),f.data=b,$.choose.core(f)},!1,!0);var j=$(document.createElement("span")).addClass("del-m");j.click(function(a){if(a.stopPropagation(),b.find(".sel-con").length>1){var c=$(this).closest(".sel-con");c.remove()}}),d.add(j).appendTo(c.appendTo(b))}function g(a){var b=[{title:lang.t("选择平台"),children:[]}];return a&&a.length&&$.each(a,function(){b[0].children.push({title:this.gpzs_name,attr:{id:this.platform_id,cid:this.platform_id,child:!0}})}),b}function h(a){var b=[];return a&&a.length&&$.each(a,function(){b.push({title:-1==this.zone_id&&-1==this.server_id?lang.t("全区全服"):this.gpzs_name,attr:{id:this.gpzs_id},selected:!1})}),b}function i(a,b,c){var d=[],e=c.attr("data-id"),f=b.find(".exist-wrap");if(a.find(".sel-con .sel-p").find(".title-m .t-name").not(c).each(function(){var a=$(this).attr("data-id");a&&d.push(a)}),inArray(e,d)){if(0==f.length){var g=$(document.createElement("span")).addClass("exist-del");g.click(function(a){a.stopPropagation(),$(this).parent().remove()}),$(document.createElement("div")).addClass("exist-wrap").text(lang.t("该项目已存在。")).append(g).appendTo(b)}}else f.length>0&&f.remove()}function j(){var a=$("#J_favor"),b=a.find(".sel-wrapper").empty(),c=$(document.createElement("div")).addClass("sel-con").css({position:"relative","z-index":2}),d=$(document.createElement("div")).addClass("sel-p");a.find(".add-m").removeClass("clicked"),b.find(".popup-txt").hide();var e={search:!0,type:1,callback:function(a,b){var c=b.attr("data-id");k(c?c:-1)},obj:d};ajaxData(getUrl("home","favor","getList"),null,function(a){e.data=l(a,"favor"),$.choose.core(e)}),d.appendTo(c.appendTo(b))}function k(a){var b=$("#J_collect"),c=b.find(".sel-wrapper").empty(),d=$(document.createElement("div")).addClass("sel-con").css({position:"relative","z-index":1}),e=$(document.createElement("div")).addClass("sel-p");b.find(".add-m").removeClass("clicked"),c.find(".popup-txt").hide();var f={search:!0,type:1,obj:e},g=function(a){f.data=l(a,"collect"),$.choose.core(f)};-1==a?g([]):ajaxData(getUrl("home","collect","getListByFavorId"),{favor_id:a},g),e.appendTo(d.appendTo(c))}function l(a,b){var c=[];if(a&&a.length)if("favor"==b){var d=$("#J_paramGameId").val(),e=$("#J_type").find("input[name='type']:checked").val();$.each(a,function(){1==e&&this.favor_type==e&&this.game_id==d?c.push({title:this[b+"_name"],attr:{id:this[b+"_id"]}}):2==e&&this.favor_type==e&&c.push({title:this[b+"_name"],attr:{id:this[b+"_id"]}})})}else $.each(a,function(){3==this.draw_type&&c.push({title:this[b+"_name"],attr:{id:this[b+"_id"]}})});return c}function m(){return 0==D&&(D=100),D--}function n(){var a=$("#J_game"),c=$("#J_from"),d=$("#J_to"),e=$("#J_date");a.change(function(){var a=$(this).find(":selected").attr("data-id");go(getUrl($("#J_r").val(),b,b,"game_id="+a))}),$(".main").find(".content").css("1"==$("#J_authchk").val()?{marginRight:45}:{marginRight:10}),e.datepick({rangeSelect:!0,monthsToShow:3,monthsToStep:3,monthsOffset:2,shortCut:!0,onClose:function(a){if(a.length){var a=e.val().split("~");a[0]=$.trim(a[0]),a[1]=$.trim(a[1]),c.val(a[0]),d.val(a[1])}else e.val(c.val()+" ~ "+d.val());z()}}),$("#J_from_to").click(function(a){e.focus(),a.stopPropagation()});var f=$("#J_platform");C(f.find(":selected").attr("data-id"),function(a){B(a),v()}),f.tmselect().change(function(){C($(this).find(":selected").attr("data-id"),function(a){B(a,!0)})}),o()}function o(){var c=$("#J_from"),d=$("#J_to"),e=$("#J_date");$("#J_cart").slidecart({top:87,panelWidth:307,height:$(a).height()-87,mask:!0,tags:1,setSingleTag:[function(){$(this).css({height:60,backgroundColor:"#8B0000"}).attr({title:"自助查询"}).addClass("selfhelp-tag").data({operands:[]});{var a=$(document.createElement("div")).addClass("icon").css({height:29,width:29,position:"relative",marginTop:15,marginLeft:6,overflow:"hidden",display:"inline-block"}).appendTo($(this));$(document.createElement("div")).addClass("search").appendTo(a)}}],setItemsArea:function(){},setFilter:function(){for(var a=["米米号","首次登陆日期","最后登陆日期","等级","当前是否为VIP","当月付费额","当月付费次数","首次按条付费时间","最后按条付费时间","累计按条付费总额","累计按条付费次数","首次包月时间","最后包月时间","累计包月总额","累计包月次数","游戏币消耗量","游戏币存量"],b=$(document.createElement("div")).css({"float":"left",width:"90%",marginLeft:10,marginBottom:8,fontSize:14}).addClass("filter-ctrl").appendTo($(this)),c=($(document.createElement("span")).css({"float":"left",fontSize:14}).text("过滤查询信息").addClass("filter-title").appendTo(b),$(document.createElement("a")).css({"float":"right",fontSize:14,cursor:"pointer"}).text(" 反选").addClass("filter-reverse").appendTo(b).click(function(){var a=$(this).parent().parent().find("input");a.trigger("click")}),$(document.createElement("a")).css({"float":"right",fontSize:14,cursor:"pointer"}).text("全选|").addClass("filter-all").appendTo(b).click(function(){var a=$(this).parent().parent().find("input");a.each(function(){$(this).attr({checked:!0})})}),0);17>c;c++){var d="filter-"+(c+1).toString(),e="input-"+(c+1).toString(),f="span-"+(c+1).toString(),g=$(document.createElement("label")).addClass(d).attr({filter_id:c+1}).css({marginLeft:10,marginRight:10,marginTop:2,width:130,"float":"left"}).appendTo($(this)),h=$(document.createElement("input")).addClass(e).attr({type:"checkbox",filter_id:c+1}).appendTo(g);0==c&&h.click();{$(document.createElement("span")).addClass(f).css({marginLeft:3,color:"#383838"}).text(a[c]).appendTo(g)}}},setUnfold:function(){{var a=$(document.createElement("div")).css({marginTop:7,marginLeft:12,height:18,width:50}).addClass("fold-area").appendTo($(this)),b=($(document.createElement("span")).css({color:"#F5F6FA",marginLeft:3,fontSize:15,fontWeight:"bold"}).text("更 多").addClass("fold-btn").appendTo(a),$(document.createElement("div")).addClass("icon").appendTo($(this)));$(document.createElement("div")).addClass("pointer-top").appendTo(b)}$(this).attr({title:"更多选项"}),$(this).click(function(){var a=$(this).find(".icon").children();a.hasClass("pointer-top")?a.removeClass("pointer-top").addClass("pointer-down"):a.hasClass("pointer-down")&&a.removeClass("pointer-down").addClass("pointer-top")})},setBtn:function(){{var a=$(document.createElement("div")).css({marginTop:8,marginLeft:88,height:26,width:112}).addClass("txt-area").appendTo($(this));$(document.createElement("span")).css({color:"#F5F6FA",marginLeft:35,fontSize:20,fontWeight:"bold"}).text("查 询").addClass("btn-txt").appendTo(a)}}}).on("slidecartrefresh",function(){ajaxData(getUrl("common","basket","getBasketInfo"),{},function(a){$(".item-con").children().remove(),$(".game-selector").children().remove(),a.length?$(".game-selector").show():$(".game-selector").hide();for(var f=0;f<a.length;f++){{var g=a[f].game_name,h=a[f].game_id,i=a[f].items,j=a[f].dft_time;a[f].filter_info}$(document.createElement("option")).text(g).attr({game_id:h}).appendTo($(".game-selector"));for(var k=0;k<i.length;k++){var l=$(document.createElement("div")).addClass("game-item").appendTo($(".item-con"));l.item({timeDft:j,timeInit:i[k].periods.length,timeInfo:i[k].periods,gameNameTxt:function(){var a=i[k].data_id==b?{}:{data_id:i[k].data_id},c=$.extend({type:i[k].type,r_id:i[k].r_id,gpzs_id:i[k].gpzs_id,game_id:h},a);$(this).text(g).attr(c)},setItemClose:function(){var a=this;$(this).click(function(){var c=$(this).parent().prev().find(".itemname-area"),d=c.find(".itemgame-con").find(".item-game").text(),e=c.find(".itemname-con").find(".item-name").text(),f=c.find(".itemgame-con").find(".item-game").attr("r_id"),g=c.find(".itemgame-con").find(".item-game").attr("data_id"),h={game_name:d,items:[{item_name:e,r_id:f,data_id:g==b?null:g}]};ajaxData(getUrl("common","basket","deleteBasketInfo"),h,function(){},!1,!0);var i=$(a).parent().parent().parent();i.remove()})},ItemNameTxt:function(){$(this).text(i[k].item_name)},setItemTime:function(){$(this).datepick({rangeSelect:!0,monthsToShow:1,monthsToStep:1,monthsOffset:1,shortCut:!1,maxDate:new Date,onClose:function(a){$("#J_cart").find(".item-ins"),$("#J_cart").find(".filter-info");if(a.length){var a=e.val().split("~");a[0]=$.trim(a[0]),a[1]=$.trim(a[1]),c.val(a[0]),d.val(a[1])}else e.val(c.val()+"~"+d.val())}})}})}}},!1,!0)}).on("slidecartsubmit",function(){var a=p($(this),"submit");r(a)}).on("slidecartsave",function(){var a=p($(this),"save");s(a)}),$(a).one("beforeunload",function(){var a=$("#J_cart");if(a.find(".game-item").length){var b=p(a,"save");s(b)}});var f=function(){var a=$(".item-con").find(".game-item").length,b=$(".item-con").find(".game-item").find(".check-item:checked").length,c="已选"+b+"条，共"+a+"条";c!=$(".notify-txt").find("span").text()&&$(".notify-txt").find("span").text(c),2>b?$(".calc-selector").children().eq(2).hide():$(".calc-selector").children().eq(2).show(),setTimeout(f,250)};f()}function p(a,c){var d=a.find(".item-ins"),e=d.find(".checkbox-con").find("input").filter(":checked").parent().parent(),f=parseInt(a.find(".game-selector").children().filter(":selected").attr("game_id")),g=a.find(".calc-selector").children().filter(":selected").attr("type"),h=a.find(".filter-info").children().find("input:checked"),i=new Array,j=new Array,k=new Object;h.each(function(){i.push(parseInt($(this).attr("filter_id")))}),e.each(function(){var a=new Object,d=$(this).find(".item-game"),e=$(this).find(".item-name");"submit"==c?a.game_id=d.attr("game_id"):"save"==c&&(a.game_name=d.text(),a.item_name=e.text()),a.type=d.attr("type"),a.gpzs_id=d.attr("gpzs_id"),a.r_id=d.attr("r_id"),d.attr("data_id")!=b&&(a.data_id=d.attr("data_id")),a.periods=new Array,$(this).find(".time-tag").each(function(){var b=$(this).find("input").val().split("~"),c=b[0],d=b[1];a.periods.push({from:c,to:d})}),j.push(a)});var l="submit"==c?{game_id:f,operation:g}:{};return k=$.extend(l,{operands:j,filter_info:i})}function q(){var a=new Date,b=$("#J_header").find(".wrapper").find(".links").find("li").eq(0).text().split("，")[1],c=a.toISOString().substring(0,10).replace(/\-/g,"")+"_"+a.getHours()+"_"+a.getMinutes(),d=b+"_"+c;return{items:[{label:{title:lang.t("本次查询名称为："),className:"title-inline"},items:[{type:"text",name:"set-name",className:"ipttxt",value:d}]}]}}function r(a){var b,c;return c=new tm.form.fieldSet($.extend({},q())),b||0==a.operands.length?say("查询前请先选中一组事件"):a.operands.length>5?say("目前对差集支持最多3个事件的计算,对交集和并集支持最多5个事件的计算"):a.operands.length>3&&"setdiff"==a.operation?say("目前对差集支持最多3个事件的计算,对交集和并集支持最多5个事件的计算"):(b=$.Dlg.Util.popup({id:"J_setSubmitName",title:lang.t("自助查询（请到我的下载中查看本次查询）"),contentHtml:$("<form>").append(c.getElement())}),b.setSaveHandler(function(){ajaxData(getUrl("tool","selfhelp","add"),$.extend(a,{file_name:$("#J_setSubmitName").find("form").find("input").val()}),function(a){$(".item-con").find(".check-item:checked").parent().parent().parent().fadeOut(function(){$(this).remove()});var b=$.Dlg.Util.message("温馨提示","正在处理，请稍候...","确定"),c="";return b.show(),0===a.code?void go(a.data.url):(1===a.code?c="由于您选择的时间间隔较长，已自动为您异步下载，您可以到页面右上角【我的下载】查看和下载！<a href='"+getUrl("tool/file/index")+"' title='现在就去' target='_blank' class='a-go'>现在就去</a>":2===a.code&&(c="文件正在处理，请耐心等待，您也可以到页面右上角【我的下载】查看！<a href='"+getUrl("tool/file/index")+"' title='现在就去' target='_blank' class='a-go'>现在就去</a>"),void(""!==c&&(b.setConfirmHtml(c),b.getManager().setPosition(b),b.show())))},"POST")}),b.show()),!1}function s(a){ajaxData(getUrl("common","basket","reviseInfo"),a,function(){},!1)}function t(){var a=$("#J_search"),b=a.find(".srh-txt"),c=a.find(".search-tag"),d=function(){$("#J_tree").jstree("search",b.val())};b.focus(function(){a.css({border:"2px solid #FE9D1F"})}).blur(function(){a.css({border:"2px solid #CCC"})}).keydown(function(a){13==a.keyCode&&d()}),c.click(function(){d()})}function u(){E&&clearTimeout(E);var a=$("#J_search").find(".search-tips");a.slideDown(200,function(){E=setTimeout(function(){a.fadeOut(300)},500)})}function v(){t();var a=$("#J_game").find(":selected").attr("data-id");$("#J_tree").jstree({plugins:["html","json_data","themes","cookies","ui","core","search"],themes:{theme:"orange"},search:{case_insensitive:!0,ajax:{url:getUrl("gamecustom","tree","search"),data:function(){return{keyword:$("#J_search").find(".srh-txt").val(),game_id:$("#J_paramGameId").val()}},success:function(a){var b=[];return $(a.data).each(function(){b.push("#custom"+this)}),b}}},json_data:{ajax:{url:getUrl("gamecustom","tree","getTree"),data:function(b){return{game_id:a,parent_id:b.attr?b.attr("node_id"):0}},success:function(a){if(0==a.result&&a.data){var b=[];return $.each(a.data,function(){b.push({data:this.node_name,state:"1"==this.is_leaf?"leaf":"closed",attr:{title:this.node_name,id:"custom"+this.node_id,node_id:this.node_id,is_leaf:this.is_leaf}})}),b}return""}}},ui:{select_limit:1}}).bind("select_node.jstree",function(a,b){if("1"===b.rslt.obj.attr("is_leaf")){var c=$("#J_content").empty().addClass("loading");ajax(getUrl("gamecustom","content","getContentList"),$.extend({node_id:b.rslt.obj.attr("node_id")},y()),function(a){0==a.result&&c.removeClass("loading has-no-data").data("content-data",fac(x(a.data,b.rslt.obj.text())))})}else b.args[1]&&b.inst.toggle_node()}).bind("search.jstree",function(a,b){0==b.rslt.nodes.length&&u()})}function w(a){for(var b=[{title:lang.t("日期"),css:{width:"200px"}}],c=a.length-1;c>-1;c--)b.push({title:a[c].toString(),className:isWeekend(a[c])?"gr":"",css:{width:"80px"}});return b}function x(a,b){if(a.data instanceof Object&&$.isEmptyObject(a.data)||a.data instanceof Array&&!a.data.length)return void $("#J_content").addClass("has-no-data").text(lang.t("没数据"));var c=[],d=w(a.date),e=function(a,b,c,d){var e={type:"hugeProgressiveTable",checkbox:!1,cartEntrance:!0,authChk:"1"==$("#J_authchk").val()?1:0,cartCallback:"tableEvent",hide:!1,dataDelay:!0,height:g,thead:b,data:[],prepareData:c,url:{url:getUrl("common","data","getTimeSeries"),page:d}};return $(a).each(function(){e.data.push([{title:this.r_name,dataId:this.type+"_"+this.r_id,iffavor:this.iffavor,ifselfhelp:this.ifselfhelp,infavor:this.infavor,inselfhelp:this.inselfhelp}])}),e},f=function(a,b,c){var d,f={type:"tabsExtendMore",child:[]},g=getUrl("gamecustom","content","getDataList","r_id="),h={title:"",child:[{type:"data",url:{timeDimension:1,page:y},child:[]}]};return $(a).each(function(){d=$.extend(!0,{},h),d.title=this.r_name,d.attr={"data-id":this.type+"_"+this.r_id},d.child[0].url.extend=g+this.r_id+"&type="+this.type,d.child[0].child.push(e([],b,c,function(a){for(var b,c=y(),d=0,e=a.length;e>d;d++)b=a[d].split(":"),c["data_info["+d+"][data_id]"]=b[0],c["data_info["+d+"][data_expr]"]=b[1]?b[1]:"";return c.by_data_expr=1,c})),f.child.push($.extend(!0,{},d))}),f},g=$(".aside").height()-$("#J_content").position().top-110-20;return a.data[1]&&a.data[0]&&(g=400),a.data[0]&&a.data[0].length&&c.push({type:"wrap",container:$("#J_content"),attr:{id:"J_singleReport"},title:b,headEnabled:!1,bottomEnabled:!1,download:function(){var a=A();a.is_multi=0,a&&$.download(getUrl("gamecustom","tree","export"),a)},child:[e(a.data[0],d,null,function(a){for(var b,c=y(),d=0,e=a.length;e>d;d++)b=a[d].split("_"),c["data_info["+d+"][type]"]=b[0],c["data_info["+d+"][r_id]"]=b[1],"report"===b[0]&&(c["data_info["+d+"][range]"]="");return c.by_data_expr=1,c})]}),a.data[1]&&a.data[1].length&&c.push({type:"wrap",container:$("#J_content"),title:b,attr:{id:"J_multiReport"},headEnabled:!1,bottomEnabled:!1,download:function(){var a=A();a.is_multi=1,a&&$.download(getUrl("gamecustom","tree","export"),a)},child:[f(a.data[1],d,function(a){var b=[];return $.each(a,function(){b.push([{title:this.data_name,dataId:0!==parseInt(this.data_id)?this.data_id:"0:"+this.data_expr,iffavor:this.iffavor,ifselfhelp:this.ifselfhelp,infavor:this.infavor,inselfhelp:this.inselfhelp}])}),b})]}),c}function y(){return{from:$("#J_from").val(),to:$("#J_to").val(),gpzs_id:$("#J_zoneServer").find(".selected-item").attr("data-id").split("_")[0],game_id:$("#J_paramGameId").val()}}function z(){ajax(getUrl("gamecustom","content","getTimePoints"),y(),function(a){if(0==a.result){var b=$("#J_content").data("content-data");b&&b.length&&$(b).each(function(){this.refresh({theadChange:!0,thead:w(a.data)})})}},"POST")}function A(){var a=$("#J_tree").jstree("get_selected");if(a.length)return{game_id:$("#J_paramGameId").val(),gpzs_id:$("#J_zoneServer").find(".selected-item").attr("data-id").split("_")[0],node_id:a.attr("node_id"),file_name:a.text(),from:$("#J_from").val(),to:$("#J_to").val()}}function B(a,b){b=b?b:!1;var c=$("#J_zoneServer");$.Select.setOptionContent(c,a),$.Select.bindEvents(c,b,function(){z()})}function C(a,b){ajax(getUrl("common","gpzs","getZoneServer"),{game_id:$("#J_paramGameId").val(),platform_id:a},function(a){if(0==a.result){var c=[];$.each(a.data,function(a){c.push({id:this.gpzs_id+"_"+this.zone_id,name:-1==this.zone_id&&-1==this.server_id?lang.t("全区全服"):this.gpzs_name,selected:0==a?!0:!1})}),b&&b(c)}else say(lang.t("获取数据错误：")+a.err_desc)})}var D=100,E=null,F={widget:null};$(function(){n(),c()})}(window);var getGameId=function(){return{game_id:$("#J_paramGameId").val()}},getGpzsId=function(){return{gpzs_id:$("#J_zoneServer").find(".selected-item").attr("data-id").split("_")[0]}},getType=function(){return{type:"report"}},getReportData=function(a,b){var c=a.parent().parent().parent();if(c.hasClass("tabs-wrapper")){var d=c.find("ul").find(".tabs-active").attr("data-id").split("_")[1];return{r_id:d,data_id:b.attr("dataid")}}return{r_id:b.attr("dataid").split("_")[1]}},getPeriods=function(){return $date=$("#J_date"),{periods:[{from:$date.val().split("~")[0],to:$date.val().split("~")[1]}]}},getFilename=function(){var a=new Date;return{file_name:a.toLocaleString()+"的查询"}},getFilterInfo=function(){return{filter_info:[1]}},blinkTag=function(){$(".selfhelp-tag").hint(1,"#FFA500")};window.tableEvent=function(){$(".fixed-table").find(".selfhelp").die().live("click",function(){var a=$(this).parent().parent().index(),b=$(this).parent().parent().parent().parent().parent().parent(),c=b.find(".fixed-body").find("tbody").find("tr").eq(a).children().eq(1),d=$.extend({game_name:$("li").find(".selected-item-white").attr("title")},getGameId(),{items:[$.extend({item_name:c.attr("title")},getType(),getGpzsId(),getReportData(b,c))]});ajaxData(getUrl("common","basket","addBasketInfo"),d,function(a){a&&blinkTag()},!1,!0)}),$(".fixed-table").find(".myfavor").die().live("click",function(){$(".fixed-table").find(".myfavor").removeClass("favor-checked"),$(this).addClass("favor-checked"),$("#J_addFavorBtn").trigger("click")})};