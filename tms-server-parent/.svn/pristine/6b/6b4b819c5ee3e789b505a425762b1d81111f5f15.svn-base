/*! taomee tongji javascript code by maverick 2015-02-04 */
!function(a){function b(a,b){var d=[];return $(a).each(function(){switch($.extend(this,b),this.type){case"wrap":d.push(new g(this));break;case"tabs":d.push(new h(this));break;case"tabsExtendMore":d.push(new i(this));break;case"data":d.push(new f(this));break;case"table":this.table===!0&&(this.hide=!1),d.push(new e(this));break;case"graph":this.graph===!1&&(this.hide=!0),d.push(tm.graph(this));break;case"hugeTable":this.table===!0&&(this.hide=!1),d.push(new c(this)),$("#J_content").find(".fixed-body table").table("rejustWrapWidth");break;case"progressiveTable":d.push(tm.progressiveTable(this));break;case"hugeProgressiveTable":d.push(tm.hugeProgressiveTable(this));break;case"listtable":d.push(tm.listtable(this));break;case"list":d.push(tm.list(this))}}),d}function c(a){return $.extend(a,{afterCreate:function(c){c.find("table").table({colNum:a.checkbox?2:1,wrapWidth:c.width(),wrapHeight:a.height?a.height:c.parent().height()}),d(c),b(a.child,{container:c.find(".fixed-body")})}}),tm.table(a)}function d(a){var b=function(a){var b=a.parent();if(b.hasClass("fixed-row")||b.hasClass("fixed-corner")){var c=b.parent().find(".fixed-column");a=0!=c.length?c.find(".fixed-table"):b.parent().find(".fixed-body .fixed-table")}return a};a.find(".fixed-table").find(".sel-total").click(function(a){a.stopPropagation(),b($(a.target).closest(".fixed-table")).find(".tbl-ckb").attr("checked",!0)}),a.find(".fixed-table").find(".sel-other").click(function(a){a.stopPropagation();var c=b($(a.target).closest(".fixed-table")),d=c.find(".tbl-ckb:checked");d.attr("checked",!1),c.find(".tbl-ckb").not(d).attr("checked",!0)})}function e(a){return a.sortable=0==a.sortable?!1:!0,$.extend(a,{afterCreate:function(b){if(a.sortable){var c={sortType:["desc","asc"],pageSizeEnabled:!0};a.average&&a.sum?c.sortFixed=[0,1]:(a.average||a.sum)&&(c.sortFixed=[0]),b.datatable(c)}}}),tm.table(a)}function f(a){var c=[],d=$.extend({},a.extend);return tm.data($.extend({refresh:function(a){$(c).each(function(){this.refresh(a)})},afterLoad:function(e){c=b(a.child,$.extend(d,{container:a.container,data:e}))}},a))}function g(a){var c,d=[];return $.extend(a,{refresh:function(a){$(d).each(function(){this.refresh(a)})},afterLoad:function(c){d=b(a.child,$.extend({},c,{container:c.container,getOption:function(){return c.superior.getOption()}}));var e=$(this).find(".mod-comment-btn");e.length&&e.hover(function(){$(this).trigger("click")},function(){$(this).find(".help-container").fadeOut("fast")})}}),c=tm.wrap(a)}function h(c){var d,e={},f=[];return $.extend(c,{refresh:function(a){var b,c=d.getContainer().tabs("getTabs"),f=d.getContainer().tabs("getActive"),g=$.extend({},e,a);$.extend(e,a),(b=f.data("child"))&&$(b).each(function(){this.refresh(g)}),f.removeClass("need-refresh"),a.noRefresh||c.not(f).filter(".tabs-loaded").addClass("need-refresh")}}),$(c.child).each(function(){this.ignore||inArray(this.ignoreId,a.responseData.currentPage.ignore)||f.push(this)}),c.child=f,d=tm.tab(c),d.getContainer().tabs({activate:function(a,b){c.tabsClick&&b.newTab.click(),b.newTab.hasClass("need-refresh")&&d.refresh($.extend(e,{noRefresh:!0}))},beforeLoad:function(d,f){c.tabsClick&&f.tab.click();var g=[];$(f.tab.data("data").child).each(function(){this.ignore||inArray(this.ignoreId,a.responseData.currentPage.ignore)||g.push(this)}),f.tab.data("child",b(g,{container:f.panel,getOption:function(){return c.getOption()},extend:e}))}}),c.tabsClick&&$.isFunction(c.tabsClick)&&d.getContainer().tabs("getTabs").click(function(){c.tabsClick($(this))}),d}function i(c){var d,e={},f=[];return $.extend(c,{refresh:function(a){var b,c=d.getContainer().tabsExtendMore("getTabs"),f=d.getContainer().tabsExtendMore("getActive"),g=$.extend({},e,a);$.extend(e,a),(b=f.data("child"))&&$(b).each(function(){this.refresh(g)}),f.removeClass("need-refresh"),a.noRefresh||c.not(f).filter(".tabs-loaded").addClass("need-refresh")}}),$(c.child).each(function(){this.ignore||inArray(this.ignoreId,a.responseData.currentPage.ignore)||f.push(this)}),c.child=f,d=tm.tab(c),d.getContainer().tabsExtendMore({activate:function(a,b){b.newTab.hasClass("need-refresh")&&d.refresh($.extend(e,{noRefresh:!0}))},beforeLoad:function(d,f){var g=[];$(f.tab.data("data").child).each(function(){this.ignore||inArray(this.ignoreId,a.responseData.currentPage.ignore)||g.push(this)}),f.tab.data("child",b(g,{container:f.panel,getOption:function(){return c.getOption()},extend:e}))}}),d}$.datatable&&$.datatable.sort&&$.extend($.datatable.sort,{"date-pre":function(a){if("undefined"==typeof a)return Date.parse("01/01/1970 00:00:00");a=a.split("~")[0];var b=Date.parse(a);return(isNaN(b)||""===b)&&(b=Date.parse("01/01/1970 00:00:00")),b},"range-pre":function(a){if("-"==a||""===a)return 0;var b=-1!==a.replace("&lt;","<").indexOf("<");return a=a.split(",")[0],b?1*a.replace(/[^0-9]/gi,"")-1:1*a.replace(/[^0-9]/gi,"")},"range-asc":function(a,b){return a-b},"range-desc":function(a,b){return b-a}}),a.fac=b}(window);