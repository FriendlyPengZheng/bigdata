/*! taomee tongji javascript code by maverick 2015-02-04 */
function ajax(a,b,c,d,e,f,g){var h=!0,i=function(a,b,c,d,e,f){gLoading.off(f),j(a,b,c,d,e)&&(h=!1,alert(window.responseData&&window.responseData.isRelease?"数据获取异常，若影响您的正常操作，请联系管理员。":"xhr.status: "+b.status+"\ntextStatus: "+c+"\nerrorThrown: "+d))},j=function(a,b,c,d,e){return $.isFunction(e)?e(b,c,d):"rejected"==b.state()&&"parsererror"!==c||"timeout"==c&&gLoading.isreload()?(h=!1,window.setTimeout(function(a){return function(){$.ajax(a),gLoading.reload()}}(a),300),!1):0==b.readyState||0==b.status?!1:!0},k=function(a){return a&&!isNaN(a.result)?!0:($.ajax({url:getUrl("f","c","a")}),!1)},l=function(a,b,c){gLoading.off(c),k(a)?$.isFunction(b)&&b(a):h=!1};if("string"==typeof a){var m=gLoading.on();gLoading.add($.ajax({url:a,data:void 0==b?"":b,async:"boolean"==typeof e?e:!0,type:d?d:"GET",timeout:isNaN(f)?2e4:f,dataType:"json",success:function(a){return function(b){l(b,c,a)}}(m),error:function(a){return function(b,c,d){i(this,b,c,d,g,a)}}(m)}),m)}else{if("object"!=typeof a)throw h=!1,new TypeError("统一ajax方法第一个参数必须为JSON或String。");var m=gLoading.on();a.dataType="json",a.error=function(a){return function(b,c,d){i(this,b,c,d,g,a)}}(m),a.url+="&ajax=ajax";var n=a.success;a.success=function(a){return function(b){l(b,n,a)}}(m),gLoading.add($.ajax(a))}return h}function getUrl(a,b,c,d){var e="index.php?r=";return void 0!==a&&(e+=a),void 0!==b&&(e+="/"+b),void 0!==c&&(e+="/"+c),"string"==typeof d&&(e=e+"&"+d),e}function go(a,b,c,d){1==arguments.length?window.open(a,"_self"):window.open(getUrl(a,b,c,d),"_self")}function setCookie(a,b,c){if(!c||isNaN(c))document.cookie=escape(a)+"="+escape(b)+";";else{var d=new Date;d.setTime(d.getTime()+c),document.cookie=escape(a)+"="+escape(b)+";expires="+d.toGMTString()}}function getCookie(a){var b=document.cookie,c=escape(a)+"=",d=b.indexOf(c);if(-1==d)return"";var e=d+c.length;return b.substring(e).split(";")[0]}function listCookies(){for(var a=document.cookie.split(";"),b=[],c="",d=0,e=a.length;e>d;d++)c=a[d].split("="),b[c[0]]=unescape(c[1]);return b}function arrayUnique(a){for(var b=new Array,c=0;c<a.length;c++){for(var d=!1,e=0;e<b.length;e++)if(a[c]==b[e]){d=!0;break}d||b.push(a[c])}return b}function inArray(a,b){if((0==a||a)&&b)for(var c=0;c<b.length;c++)if(a==b[c])return!0;return!1}function isWeekend(a){var b=a.split("-"),c=new Date(b[0],b[1]-1,b[2]).getDay();return 0==c||6==c?!0:!1}function inputTimeOptimize(){$("input[type=time], .time-input").live("blur",function(){var a=$(this).val();if(a=$.trim(a.replace("：",":")),-1==a.indexOf(":"))2==a.length?a="0"+a.charAt(0)+":0"+a.charAt(1):3==a.length?parseInt(a.charAt(1))>5?parseInt(a.charAt(0))<2&&(a=a.substring(0,2)+":0"+a.charAt(2)):parseInt(a.charAt(0))>2?a="0"+a.charAt(0)+":"+a.substring(1,3):2==parseInt(a.charAt(0))&&parseInt(a.charAt(1))>3&&(a="02:"+a.substring(1,3)):4==a.length&&(a=a.substring(0,2)+":"+a.substring(2,4));else{var b=a.split(":");if(isNaN(b[0])||isNaN(b[1]))return;var c=parseInt(b[0]),d=parseInt(b[1]);10>c&&(c="0"+c),10>d&&(d="0"+d),a=c+":"+d}$(this).val(a)})}function jsonEncode(a){return window.JSON?JSON.stringify(a):void 0}function jsonDecode(a){return window.JSON?JSON.parse(a):void 0}function getArgs(){return parseArgs(location.search.substring(1))}function parseArgs(a){for(var b={},c=a.split("&"),d=0;d<c.length;d++){var e=c[d].indexOf("=");if(-1!=e){var f=decodeURIComponent(c[d].substring(0,e)),g=decodeURIComponent(c[d].substring(e+1));b[f]=g}}return b}function empty(a){if(void 0==a||null==a)return!0;if("Array"==a.constructor)return 0==a.length;switch(typeof a){case"string":return"0"==a||0==a.length;case"number":return 0==a;case"boolean":return!a;case"object":return!1;default:return!0}}function executeFnByName(a,b){var c=Array.prototype.slice.call(arguments,2);namespaces=a.split("."),b=b||window;for(var d=namespaces.pop(),e=0;e<namespaces.length;e++)b=b[namespaces[e]];return b[d].apply(this,c)}function hasFlashPlayVersion(a){var b=document,c="undefined",d=navigator,e="Shockwave Flash",f="object",g="application/x-shockwave-flash",h=window,i="ShockwaveFlash.ShockwaveFlash",j=function(){var a=typeof b.getElementById!=c&&typeof b.getElementsByTagName!=c&&typeof b.createElement!=c,j=d.userAgent.toLowerCase(),k=d.platform.toLowerCase(),l=/win/.test(k?k:j),m=/mac/.test(k?k:j),n=/webkit/.test(j)?parseFloat(j.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,o=!1,p=[0,0,0],q=null;if(typeof d.plugins!=c&&typeof d.plugins[e]==f)q=d.plugins[e].description,!q||typeof d.mimeTypes!=c&&d.mimeTypes[g]&&!d.mimeTypes[g].enabledPlugin||(T=!0,o=!1,q=q.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),p[0]=parseInt(q.replace(/^(.*)\..*$/,"$1"),10),p[1]=parseInt(q.replace(/^.*\.(.*)\s.*$/,"$1"),10),p[2]=/[a-zA-Z]/.test(q)?parseInt(q.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof h.ActiveXObject!=c)try{var r=new ActiveXObject(i);r&&(q=r.GetVariable("$version"),q&&(o=!0,q=q.split(" ")[1].split(","),p=[parseInt(q[0],10),parseInt(q[1],10),parseInt(q[2],10)]))}catch(s){}return{w3:a,pv:p,wk:n,ie:o,win:l,mac:m}}(),k=j.pv,l=a.split(".");return l[0]=parseInt(l[0],10),l[1]=parseInt(l[1],10)||0,l[2]=parseInt(l[2],10)||0,k[0]>l[0]||k[0]==l[0]&&k[1]>l[1]||k[0]==l[0]&&k[1]==l[1]&&k[2]>=l[2]?!0:!1}function PoolQueue(){this.poolLen=2,this.poolQueue=[]}function overlayer(a){window.layerCnt++;var b={text:"加载中..."};$.extend(b,a);var c=$("#J_layer"),d=$("#J_notice"),e=$("body");0==c.length?c=$(document.createElement("div")).addClass("layer").attr("id","J_layer").appendTo(e):c.show(),0==d.length?d=$(document.createElement("div")).addClass("notice").attr("id","J_notice").text(b.text).css({left:_get_left(d)+"px",top:0}).appendTo(e):d.css({left:_get_left(d)+"px",top:0}).show()}function hidelayer(a){if(window.layerCnt--,0==window.layerCnt){var a=a?a:"操作成功",b=$("#J_notice");b.text(a),$("#J_layer").add(b).fadeOut(1e3)}}function _get_left(a,b){b=b?b:$(window);var c=$(window).width(),d=a.width()?a.width():130;return c-d>0?(c-d)/2:0}function notify(a,b){var c=$(document.createElement("div"));void 0===b&&(b=!0),b=b&&!0,c.append(a),c.css({position:"fixed",top:"0px"}).appendTo("body");var d=c.width();if(c.addClass("notice").css({left:($(window).width()-d)/2}),c.slideDown("fast",function(){b&&(c.get(0).timer=window.setTimeout(function(){c.slideUp("fast"),window.clearTimeout(c.get(0).timer),c.remove()},3e3))}),b)return c;var e=$(document.createElement("div"));return e.addClass("mask").appendTo("body"),c.add(e)}window.gLoadingCnt=0,window.gReloadCnt=0,window.layerCnt=0;var gLoading=gLoading||{};gLoading={pool:[],on:function(){return window.gLoadingCnt++,gLoading.pool.length},off:function(a){window.gLoadingCnt--,window.gReloadCnt--,gLoading.pool[a]=null},reload:function(){window.gReloadCnt++},isreload:function(){return gReloadCnt>10?!1:!0},disable:function(){return 0===gLoadingCnt?!1:!0},add:function(a,b){gLoading.pool[a]=b},cancel:function(){for(var a=gLoading.pool.length;a--;)gLoading.pool[a]&&gLoading.pool[a].abort()}},window.gLoading=gLoading;var LocalStorage={set:function(a,b,c){window.localStorage?window.localStorage.setItem(a,b):setCookie(a,b,c)},get:function(a){return unescape(window.localStorage?window.localStorage.getItem(a):getCookie(a))}},SessionStorage={set:function(a,b){window.sessionStorage?window.sessionStorage.setItem(a,b):setCookie("session."+a,b)},get:function(a){return unescape(window.sessionStorage?window.sessionStorage.getItem(a):getCookie("session."+a))},remove:function(a){window.sessionStorage?window.sessionStorage.removeItem("session."+a):setCookie("session."+a,"",(new Date).getTime()-1)},clear:function(){if(window.sessionStorage)window.sessionStorage.clear();else{var a=listCookies(),b=(new Date).getTime()-1;if(a.length)for(var c in a)0==c.indexOf("session.")&&setCookie(c,"",b)}}},Prefrence={set:function(a,b,c){LocalStorage.set("pref."+a,b,c)},get:function(a){return LocalStorage.get("pref."+a)}};$.date={getWeekNum:function(a){if($.date.isDate(a)){var b=a.split("-");return new Date(b[0],b[1]-1,b[2]).getDay()}return null},isDate:function(a){return/^\d{4}-\d{1,2}-\d{1,2}$/.test(a)},getChWeek:function(a){switch($.date.getWeekNum(a)){case 1:return"周一";case 2:return"周二";case 3:return"周三";case 4:return"周四";case 5:return"周五";case 6:return"周六";case 0:return"周日";default:return""}},getDate:function(a,b){if($.date.isDate(a)){var c=a.split("-"),d=new Date(c[0],c[1]-1,c[2]);return d.setTime(d.getTime()+864e5*b),d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate()}return a},parseFullMonth:function(a){return 10>a&&(a="0"+parseInt(a,10)),a},getNow:function(){var a=new Date;return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()},getCurMonth:function(){var a=new Date;return a.getFullYear()+"-"+(a.getMonth()+1)}},window.Keys={CTRL:17,ALT:18,ENTER:13,SEARCH:191,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DOT:190,N0:48,N1:49,N2:50,N3:51,N4:52,N5:53,N6:54,N7:55,N8:56,N9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90},window.ShortCut={sequence:[],add:function(a){return this.sequence[this.sequence.length]=a},isCommand:function(cmd){var len=cmd.length;if(this.sequence.length<cmd.length)return!1;for(var j=0,i=this.sequence.length-cmd.length;len>j;++j){if(eval("var tmp = Keys."+cmd[j].toUpperCase()),tmp!=this.sequence[i])return!1;i++}return!0},clear:function(){this.sequence=[]}},function($){$.fn.extend({disableSelection:function(){return $(this).length>1?($(this).each(function(){$(this).disableSelection()}),this):0==this.length?this:(this.get(0).onselectstart=function(){return!1},this)},enableSelection:function(){return $(this).length>1?($(this).each(function(){$(this).disableSelection()}),this):0==this.length?this:(this.get(0).onselectstart=function(){return!0},this)},hint:function(a,b){var c=this,d=a,e=b,f=c.css("background-color");void 0!=a&&a>0||(d=2),void 0==b&&(e="#FFF2B1");for(var g=0;d>g;g++)window.setTimeout(function(){c.css("background-color",e)},300*(2*g+1)),window.setTimeout(function(){c.css("background-color",f)},2*(g+1)*300);return $(this).focus(),this},verticalTable:function(){$(this).find(".detail").hover(function(){$(this).addClass("bg-table-highlight")},function(){$(this).removeClass("bg-table-highlight")})},date:function(){if(!$(this).datepicker)throw new Error("Please load jQuery-UI's datepicker first.");$(this).datepicker({dateFormat:"yy-mm-dd",showOn:"button",buttonImage:responseData.resServer+"/common/js/jqDatePicker/themes/base/images/calendar.png",buttonImageOnly:!0})},dragIt:function(a){if($(this).length>1)return $(this).each(function(){$(this).dragIt(a)}),this;var b=this,c={limit:$(document.body),x:!0,y:!0};$.extend(c,a);var d={FREE:0,START:10,DRAGGING:20},e={DRAG_START:"dragstart",DRAG_MOVE:"dragmove",DRAG_END:"dragend"};return this.dragState=d.FREE,this.position={x:0,y:0},this.width=$(b).outerWidth(),this.height=$(b).outerHeight(),void 0!=c.holder?$(b).find(c.holder).css({cursor:"move"}):$(b).css({cursor:"default"}),$.fn.isDragging=function(){return this.dragState&&this.dragState==d.DRAGGING},function(){$(b).mousedown(function(a){return 1!=a.which||void 0!=c.holder&&!$(a.target).is(c.holder)?void 0:(b.dragState=d.START,b.position.x=a.pageX,b.position.y=a.pageY,b.get(0).setCapture&&b.get(0).setCapture(),!1)}),$(document).mousemove(function(a){if(1==a.which&&b.dragState!=d.FREE){b.dragState==d.START&&($(b).trigger(e.DRAG_START),b.dragState=d.DRAGGING,$(b).css({left:$(b).position().left,top:$(b).position().top,position:"absolute",opacity:c.opacity>0&&c.opacity<1?c.opacity:1}));var f=a.pageX-b.position.x,g=a.pageY-b.position.y,h=$(b).position(),i=h.left+f,j=h.top+g;if(c.limit&&1==c.limit.length){var k=c.limit.position();i<k.left?(i=k.left,b.position.x-=h.left-k.left):i+b.width>k.left+c.limit.width()?(i=k.left+c.limit.width()-b.width,b.position.x+=k.left+c.limit.width()-h.left-b.width):b.position.x=a.pageX,j<k.top?(j=k.top,b.position.y-=h.top-k.top):j+b.height>k.top+c.limit.height()?(j=k.top+c.limit.height()-b.height,b.position.y+=k.top+c.limit.height()-h.top-b.height):b.position.y=a.pageY}else b.position.x=a.pageX,b.position.y=a.pageY;c.x&&c.y?$(b).css({left:i,top:j}):c.x?c.y||$(b).css("left",i):$(b).css("top",j),$(b).trigger(e.DRAG_MOVE)}}),$(document).mouseup(function(a){1==a.which&&($(b).trigger(e.DRAG_END),b.dragState=d.FREE,b.get(0).releaseCapture&&b.get(0).releaseCapture(),$(b).css({opacity:1}))})}(),this},jsonForm:function(fn){var options={data:{ajax:"ajax"},success:function(data){try{data=eval("("+data+")"),fn(data)}catch(e){say("服务端错误，请稍后再试。(invalid json type)")}}};$(this).ajaxSubmit(options)},onloadTip:function(a,b){var c=this,d=$(this).position();void 0==b&&(b="top");var e=document.createElement("div");$(e).addClass("tip-trangle tip-trangle-"+b);var f=document.createElement("div");return $(f).addClass("tip-container").append(e).append(a).css({left:(d.left<10?10:d.left)-10,top:d.top+$(c).height()+20}).appendTo($("#J_main")).fadeIn("slow"),window.setTimeout(function(){$(f).fadeOut("slow",function(){$(this).remove()})},3e3),f},newTip:function(){if($(this).length>1)return $(this).each(function(){$(this).newTip()}),this;if(0==$(this).length)return this;var a=$(this).position(),b=document.createElement("center");$(b).addClass("new-tip-container").text("New").css({position:"absolute",left:(a.left<10?10:a.left)-10,top:a.top-20}).mouseover(function(){$(this).fadeOut(900,function(){$(this).remove()})}),$(this).before(b);var c=function(){$(b).animate({fontSize:"16px"},"slow",function(){$(this).animate({fontSize:"12px"},"slow",c)})};return window.setTimeout(function(){$(b).animate({fontSize:"14px"},"slow",c)},1e3),b},password:function(){return this},setFixed:function(a){a=$.extend({position:"top",relative:0},a);var b=$(this).height(),c=$(this).width(),d=$(this).position().top,e=this,f=$(document.createElement("div"));f.css({height:b,position:"relative"}),$(this).wrap(f),$(this).css({top:d+a.relative,width:c}),$(document).scroll(function(){$(document).scrollTop()>b?e.addClass("fixed-container"):e.removeClass("fixed-container")}).scroll()},hasScrollBar:function(){return this.get(0).scrollHeight>this.innerHeight()}})}(jQuery),window.Path={getResPath:function(a){return responseData.resServer+a},modifyPath:function(a,b){var c=location.href;if(-1===c.search("&"+a+"=")&&-1===c.search("/?"+a+"="))return c+=-1===c.indexOf("?")?"?":"&",c+a+"="+b;var d=c.match(new RegExp("[&?]+"+a+"=([^&#]+)"));return d=d?d[1]:"",c.replace(a+"="+d,a+"="+b)}},window.say=function(a,b,c){$.Dlg.Util.alert(a,b,c)},String.prototype.repeat=function(a){for(var b=this.toString();--a;)b+=b;return b},String.prototype.pad=function(a,b){if(b=String(b)||" ",!a||isNaN(a)||0>a)return this;if(this.length>=a)return this;var c=this.toString(),d=0;d=Math.floor((a-this.length)/b.length);var e=a-this.length-b.length*d;return d&&(c=b.repeat(d)+c),e&&b.length>e&&(c=b.slice(0,a-1)+c),c},String.prototype.addCommas=function(a){nStr=this+"";var b=nStr.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;if(1==b.length&&a&&!isNaN(a)){d=".";for(var f=0;f<parseInt(a,10);f++)d+="0"}for(;e.test(c);)c=c.replace(e,"$1,$2");return c+d},PoolQueue.prototype={get:function(){var a=this.poolQueue.length,b={};if(a<this.poolLen)b=new Pool,b.str=a,this.poolQueue.push(b);else{var c=1;for(b=this.poolQueue[0];c<this.poolLen;){var d=this.poolQueue[c];b.waitRequest.length>d.waitRequest.length&&(b=d),c++}}return b}};var Pool=function(){this.clear()};Pool.prototype={init:function(){if(this.stat=!0,!this.interval){var a=this;this.interval=window.setInterval(function(){a.send()},500)}},clear:function(){this.waitRequest=[],this.isRequest=0,this.length=3,this.request=[],this.interval=null},stop:function(){if(this.interval){var a=this;window.clearInterval(a.interval),this.interval=null}},add:function(a,b,c,d){d=d?d:"GET",this.waitRequest.push({url:a,param:b,fn:c,type:d}),this.push(),this.interval||this.send(),this.init()},send:function(){var a=this.request.length,b=this;if(this.waitRequest.length||this.request.length||this.stop(),a)for(;this.isRequest<this.length&&this.request.length;){var c=this.request.shift();c&&(this.isRequest++,window.setTimeout(function(a){return function(){ajax(a.url,a.param,function(a,c){return function(d){b.log(+new Date-c),a.fn(d),b.push(),b.isRequest--,a=null}}(a,+new Date),a.type)}}(c),2))}},log:function(a){this.stat&&(msglog("0xfffffffb","",a),msglog("0xfffffff6","",a))},push:function(){this.request.length<this.length&&this.waitRequest.length&&this.request.push(this.waitRequest.shift())}},$.extend({download:function(a,b){var c=$.Dlg.Util.message("温馨提示","正在处理，请稍候...","确定"),d="";a=a.split("?"),b=b?b:{},c.show(),ajax(a[0],$.extend({},parseArgs(a[1]),b),function(a){if(0==a.result){if(c.hide(),0===a.data.code)return void go(a.data.url);1===a.data.code?d="由于您选择的时间间隔较长，已自动为您异步下载，您可以到页面右上角【我的下载】查看和下载！<a href='"+getUrl("tool/file/index")+"' title='现在就去' target='_blank' class='a-go'>现在就去</a>":2===a.data.code&&(d="文件正在处理，请耐心等待，您也可以到页面右上角【我的下载】查看！<a href='"+getUrl("tool/file/index")+"' title='现在就去' target='_blank' class='a-go'>现在就去</a>")}else d="下载错误："+a.err_desc;""!==d&&(c.setConfirmHtml(d),c.getManager().setPosition(c),c.show())},"POST")}});var Lang=function(){var a=function(a,b){this.defaultLang=a,this.currentLang=b||"zh_CN"};return a.prototype.pack={},a.prototype.specialCharacters=/[-\/\\^$*+?.()|[\]{}]/g,a.prototype.t=function(a,b){if(this.defaultLang!==this.currentLang&&this.pack[this.currentLang]&&(a=this.pack[this.currentLang][a]||a),1===arguments.length)return a;if($.isPlainObject(b))for(var c in b)a=a.replace(new RegExp(c.replace(this.specialCharacters,"\\$&"),"g"),b.key);else if("string"==typeof b)for(var d=1;d<arguments.length;d++)a=a.replace(new RegExp(("{"+d+"}").replace(this.specialCharacters,"\\$&"),"g"),arguments[d]);return a},a}();window.lang=new Lang("zh_CN",window.responseData.locale);