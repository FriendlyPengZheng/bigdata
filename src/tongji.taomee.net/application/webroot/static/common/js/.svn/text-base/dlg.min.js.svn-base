/*! taomee tongji javascript code by maverick 2015-02-04 */
!function(a){var b=0;a.extend({Dlg:{CONST:{VOID_LINK:"javascript:void(0)",CLOSE_BUTTON_TITLE:"关闭",DEFAULT_TITLE:"消息",DEFAULT_CONFIRM_TEXT:"您确定要这么做吗？",DEFAULT_WANING_TEXT:"请等待！",MESSAGE_DIALOG_BUTTON:"好的",OK_BUTTON_TEXT:"确定",SAVE_BUTTON_TEXT:"保存",YES_BUTTON_TEXT:"是",NO_BUTTON_TEXT:"否",CANCEL_BUTTON_TEXT:"取消",MASK_COLOR:"#999",MASK_OPACITY:.7,CSS_DLG:"ui-dlg",CSS_HEADER_COMMON:"ui-header-common",CSS_HEADER_SIMPLE:"ui-header-simple",CSS_TITLE:"ui-title",CSS_CONT:"ui-cont",CSS_BOTTOM:"ui-bottom",CSS_CONTENT:"ui-content",CSS_TEXT:"ui-hgt16",CSS_BTNLARGE:"btn-l-dft",CSS_BTNSMALL:"btn-s-dft",CSS_WARNING:"warning-l",CSS_OK:"ok-l",CSS_ERROR:"err-l",BLANK_STRING:"",HTML_DIV:"div",HTML_SPAN:"span",HTML_A:"a",HTML_IFRAME:"iframe",HTML_H3:"h3",UNDEFINED:"undefined",AJAX_ERROR_MSG:"网络错误，请稍候再试..."},Util:{alert:function(b,c,d){var e=new a.Dlg.DialogFactory({dialogType:c?a.Dlg.DialogType.ALERT.RIGHT:a.Dlg.DialogType.ALERT.ERROR,alertText:b.toString()}).getInstance();return e.show(d),e},confirm:function(b,c,d,e,f){var g=new a.Dlg.DialogFactory({dialogType:a.Dlg.DialogType.CONFIRM,title:b,confirmText:c,closeButtonEvent:f}).getInstance();return g.setOkHandler(d),g.setCancelHandler(e),g.show(),g},popup:function(b){var c=new a.Dlg.DialogFactory({dialogType:a.Dlg.DialogType.POPUP,title:b.title?b.title:a.Dlg.CONST.DEFAULT_TITLE,closeButtonEvent:b.close,saveCallback:b.saveCallback?b.saveCallback:null}).getInstance(),d=c.getContainer();return a(d).attr("id",b.id?b.id:"J_popup"),b.contentHtml&&c.setConfirmHtml(b.contentHtml),b.save&&c.setSaveHandler(b.save),b.cancel&&c.setCancelHandler(b.cancel),b.callback&&b.callback(a(d)),b.width&&a(d).width(b.width),c},message:function(b,c,d){var e=new a.Dlg.DialogFactory({dialogType:a.Dlg.DialogType.MESSAGE,title:b,confirmText:c,okButtonText:void 0==d?a.Dlg.CONST.MESSAGE_DIALOG_BUTTON:d}).getInstance();return e},remote:function(b){var c=new a.Dlg.DialogFactory({dialogType:a.Dlg.DialogType.COMMON,url:b}).getInstance();return c.show(),c},warning:function(b,c,d){var e=new a.Dlg.DialogFactory({dialogType:a.Dlg.DialogType.WARNING,title:b,warningText:c,warningType:d?d:0}).getInstance();return e.show(),e}},DialogType:{COMMON:1,ALERT:{RIGHT:2,ERROR:3},CONFIRM:4,MESSAGE:5,WARNING:6,POPUP:7},ButtonType:{NULL:0,OK:1,YESNO:2,OKCANCEL:3,SAVECANCEL:4},WarningType:{WARNING:0,OK:1,ERROR:2},_get_warning_class:function(b){var c="";switch(b){case a.Dlg.WarningType.WARNING:c=a.Dlg.CONST.CSS_WARNING;break;case a.Dlg.WarningType.OK:c=a.Dlg.CONST.CSS_OK;break;case a.Dlg.WarningType.ERROR:c=a.Dlg.CONST.CSS_ERROR}return c},DialogFactory:function(b){var c={dialogType:a.Dlg.DialogType.MESSAGE,buttonType:a.Dlg.ButtonType.NULL,warningType:a.Dlg.WarningType.WARNING,maskZIndex:80,dialogZIndex:90,closeDelay:1500,fadeSpeed:500,contentHtml:a.Dlg.CONST.BLANK_STRING,title:a.Dlg.CONST.DEFAULT_TITLE,message:a.Dlg.CONST.BLANK_STRING,confirmText:a.Dlg.CONST.DEFAULT_CONFIRM_TEXT,alertText:a.Dlg.CONST.BLANK_STRING,warningText:a.Dlg.CONST.DEFAULT_WARNING_TEXT,hideTarget:null,okButtonText:a.Dlg.CONST.OK_BUTTON_TEXT,saveButtonText:a.Dlg.CONST.SAVE_BUTTON_TEXT,yesButtonText:a.Dlg.CONST.YES_BUTTON_TEXT,noButtonText:a.Dlg.CONST.NO_BUTTON_TEXT,cancelButtonText:a.Dlg.CONST.CANCEL_BUTTON_TEXT,closeButtonEvent:null,okButtonEvent:null,yesButtonEvent:null,noButtonEvent:null,cancelButtonEvent:null};a.extend(c,b),this.getInstance=function(){var b=null;switch(c.dialogType){case a.Dlg.DialogType.COMMON:b=new a.Dlg.CommonDialog(c);break;case a.Dlg.DialogType.ALERT.RIGHT:case a.Dlg.DialogType.ALERT.ERROR:b=new a.Dlg.AlertDialog(c);break;case a.Dlg.DialogType.CONFIRM:c.buttonType!=a.Dlg.ButtonType.YESNO&&c.buttonType!=a.Dlg.ButtonType.OKCANCEL&&(c.buttonType=a.Dlg.ButtonType.OKCANCEL),b=new a.Dlg.ConfirmDialog(c);break;case a.Dlg.DialogType.POPUP:c.buttonType=a.Dlg.ButtonType.SAVECANCEL,b=new a.Dlg.ConfirmDialog(c);break;case a.Dlg.DialogType.WARNING:b=new a.Dlg.WarningDialog(c);break;default:c.buttonType=a.Dlg.ButtonType.OK,b=new a.Dlg.ConfirmDialog(c)}b.options=c;var d=b.getContainer();return a(d).dragIt({holder:"."+a.Dlg.CONST.CSS_TITLE,limit:!1}),b}},CommonDialog:function(b){var c=this,d=new a.Dlg.DialogManager(b),e=null,f={SHOW:"show",HIDE:"hide",BEFORE_CLOSE:"beforeClose",SUCCESS:"success",ERROR:"error"},g=document.createElement(a.Dlg.CONST.HTML_DIV),h=document.createElement(a.Dlg.CONST.HTML_DIV),i=document.createElement(a.Dlg.CONST.HTML_A),j=document.createElement(a.Dlg.CONST.HTML_H3),k=document.createElement(a.Dlg.CONST.HTML_DIV),l=document.createElement(a.Dlg.CONST.HTML_DIV);a(g).addClass(a.Dlg.CONST.CSS_DLG).css({position:"absolute",zIndex:b.dialogZIndex}),b.width&&a(g).css("width",b.width),a(h).addClass(a.Dlg.CONST.CSS_HEADER_COMMON),a(k).addClass(a.Dlg.CONST.CSS_CONT),a(l).addClass(a.Dlg.CONST.CSS_BOTTOM),i.href=a.Dlg.CONST.VOID_LINK,i.title=a.Dlg.CONST.CLOSE_BUTTON_TITLE,a(i).text("x"),a(j).addClass(a.Dlg.CONST.CSS_TITLE).html(b.title),a(h).append(a(j).add(a(i)));var m=null;typeof b.url==a.Dlg.CONST.UNDEFINED?(m=document.createElement(a.Dlg.CONST.HTML_DIV),a(m).addClass(a.Dlg.CONST.CSS_CONTENT).html(b.contentHtml).appendTo(a(k))):(m=k,a.ajax({url:b.url,success:function(b){a(g).trigger(f.SUCCESS),a(k).html(b)},error:function(){a(g).trigger(f.ERROR),a(k).append(a.Dlg.CONST.AJAX_ERROR_MSG)}}));var n=function(){new a.Dlg.ButtonFactory(b).applyTo(c)};a(g).hide().append(h).append(k).append(l).appendTo(document.body),a(i).click(function(){a.isFunction(b.closeButtonEvent)&&b.closeButtonEvent(),c.fadeOut(!1)}),this.setOkHandler=function(a){b.okButtonEvent=a,n()},this.setYesHandler=function(a){b.yesButtonEvent=a,n()},this.setNoHandler=function(a){b.noButtonEvent=a,n()},this.setCancelHandler=function(a){b.cancelButtonEvent=a,n()},this.success=function(b){if(a.isFunction(b))a(g).bind(f.SUCCESS,b);else{if(void 0!=b)throw new a.Dlg.paramTypeException(0,typeof b);a(g).trigger(f.SUCCESS)}},this.error=function(b){if(a.isFunction(b))a(g).bind(f.ERROR,b);else{if(void 0!=b)throw new a.Dlg.paramTypeException(0,typeof b);a(g).trigger(f.ERROR)}},this.beforeClose=function(a){e=a};var o=function(){return!a.isFunction(e)||e()};this.show=function(b){a.isFunction(b)?a(g).bind(f.SHOW,b):(d.showMask(),b=void 0==b?0:b,a(g).show(b,function(){a(this).trigger(f.SHOW)}),a(l).find("."+a.Dlg.CONST.CSS_BTNSMALL+", ."+a.Dlg.CONST.CSS_BTNLARGE).filter(":first").focus())},this.fadeIn=function(b){a.isFunction(b)?a(g).bind(f.SHOW,b):(d.showMask(),b=void 0==b?0:b,a(g).fadeIn(b,function(){a(this).trigger(f.SHOW)}))},this.hide=function(b){a.isFunction(b)?a(g).bind(f.HIDE,b):(0==b||o())&&(d.hideMask(),b=void 0==b?0:b,a(g).hide(b,function(){a(this).trigger(f.HIDE)}))},this.fadeOut=function(c){a.isFunction(c)?a(g).bind(f.HIDE,c):(c===!1||o())&&(d.hideMask(),c=void 0==c?b.fadeSpeed:c,a(g).fadeOut(c,function(){a(this).trigger(f.HIDE)}))},this.getContainer=function(){return g},this.getContent=function(){return m},this.getBottom=function(){return l},this.getContentHtml=function(){return a(m).html()},this.setContentHtml=function(b){a(m).html(b)},typeof b.url==a.Dlg.CONST.UNDEFINED&&n(),this.getManager=function(){return d},d.setPosition(this)},AlertDialog:function(b){var c=this,d=new a.Dlg.DialogManager(b),e=null,f=document.createElement(a.Dlg.CONST.HTML_DIV),g=document.createElement(a.Dlg.CONST.HTML_DIV),h=document.createElement(a.Dlg.CONST.HTML_DIV),i=document.createElement(a.Dlg.CONST.HTML_SPAN);a(f).addClass(a.Dlg.CONST.CSS_DLG).css({position:"absolute",zIndex:b.dialogZIndex}),a(g).addClass(a.Dlg.CONST.CSS_CONT),a(h).addClass(a.Dlg.CONST.CSS_CONTENT),a(i).addClass(b.dialogType==a.Dlg.DialogType.ALERT.ERROR?"err-l":"ok-l"),a(g).append(a(h).append(a(i).text(b.alertText))),a(f).hide().append(g).appendTo(document.body),this.show=function(g){window.clearTimeout(e),d.showMask(),a(f).show(),e=window.setTimeout(function(){c.fadeOut(b.fadeSpeed,g)},b.closeDelay)},this.hide=function(b){d.hideMask(),a(f).hide(0,b)},this.fadeOut=function(c,e){d.hideMask(),void 0==c&&(c=b.fadeSpeed),a(f).fadeOut(c,e)},this.getContainer=function(){return f},this.getContent=function(){return h},d.setPosition(this)},DialogManager:function(c){this.options=c;var d=document.createElement(a.Dlg.CONST.HTML_DIV);a(d).css({position:"absolute",backgroundColor:a.Dlg.CONST.MASK_COLOR,opacity:a.Dlg.CONST.MASK_OPACITY,top:0,left:0,width:a(document.body).width(),zIndex:c.maskZIndex}).hide().appendTo(document.body);var e=function(){a(d).css({width:a(document.body).width(),height:a(document).height()})};a(window).scroll(e),a(window).resize(e),this.showMask=function(){b++,null!=c.hideTarget&&a.isFunction(c.hideTarget.css)&&c.hideTarget.css("visibility","hidden"),a(d).css({height:a(document).height()}).show()},this.hideMask=function(){a(d).fadeOut("fast",function(){null!=c.hideTarget&&a.isFunction(c.hideTarget.css)&&c.hideTarget.css("visibility","visible")}),b--},this.getElement=function(){return d},this.setPosition=function(b){var c=b.getContainer(),d=a(document).scrollTop(),e=a(document).scrollLeft(),f=a(window).width(),g=a(window).height(),h=a(c).width(),i=a(c).height(),j=d+parseInt((g-i)/2,10),k=e+parseInt((f-h)/2,10);a(c).css({top:Math.max(50,j),left:k})}},ConfirmDialog:function(b){var c=this,d=new a.Dlg.DialogManager(b),e=null,f={SHOW:"show",HIDE:"hide",BEFORE_CLOSE:"beforeClose"},g=document.createElement(a.Dlg.CONST.HTML_DIV),h=document.createElement(a.Dlg.CONST.HTML_DIV),i=document.createElement(a.Dlg.CONST.HTML_H3),j=document.createElement(a.Dlg.CONST.HTML_A),k=document.createElement(a.Dlg.CONST.HTML_DIV),l=document.createElement(a.Dlg.CONST.HTML_DIV),m=document.createElement(a.Dlg.CONST.HTML_DIV),n=document.createElement(a.Dlg.CONST.HTML_DIV);a(g).addClass(a.Dlg.CONST.CSS_DLG).css({position:"absolute",zIndex:b.dialogZIndex}),a(h).addClass(a.Dlg.CONST.CSS_HEADER_COMMON),a(k).addClass(a.Dlg.CONST.CSS_CONT),a(n).addClass(a.Dlg.CONST.CSS_BOTTOM),j.href=a.Dlg.CONST.VOID_LINK,j.title=a.Dlg.CONST.CLOSE_BUTTON_TITLE,a(j).text("x"),a(i).addClass(a.Dlg.CONST.CSS_TITLE).text(b.title),a(j).add(a(i)).appendTo(a(h)),a(l).addClass(a.Dlg.CONST.CSS_CONTENT),a(m).addClass(a.Dlg.CONST.CSS_TEXT).text(b.confirmText),a(k).append(a(l).append(m)),a(g).hide().append(h).append(k).append(n).appendTo(document.body),a(j).click(function(){a.isFunction(b.closeButtonEvent)&&b.closeButtonEvent(g),c.fadeOut(!1)});var o=function(){new a.Dlg.ButtonFactory(b).applyTo(c)};this.setOkHandler=function(a){b.okButtonEvent=a,o()},this.setSaveHandler=function(a){b.saveButtonEvent=a,o()},this.setYesHandler=function(a){b.yesButtonEvent=a,o()},this.setNoHandler=function(a){b.noButtonEvent=a,o()},this.setCancelHandler=function(a){b.cancelButtonEvent=a,o()},this.show=function(b){a.isFunction(b)?a(g).bind(f.SHOW,b):(d.showMask(),d.setPosition(this),b=void 0==b?0:b,a(g).show(b,function(){a(this).trigger(f.SHOW)}),a(n).find("."+a.Dlg.CONST.CSS_BTNLARGE+", ."+a.Dlg.CONST.CSS_BTNSMALL).filter(":first").focus())},this.fadeIn=function(b){a.isFunction(b)?a(g).bind(f.SHOW,b):(d.showMask(),d.setPosition(this),b=void 0==b?0:b,a(g).fadeIn(b,function(){a(this).trigger(f.SHOW)}))},this.beforeClose=function(a){e=a};var p=function(){return!a.isFunction(e)||e()};this.hide=function(b){a.isFunction(b)?a(g).bind(f.HIDE,b):p()&&(d.hideMask(),b=void 0==b?0:b,a(g).hide(b,function(){a(this).trigger(f.HIDE)}))},this.fadeOut=function(c){a.isFunction(c)?a(g).bind(f.HIDE,c):p()&&(d.hideMask(),c=void 0==c?b.fadeSpeed:c,a(g).fadeOut(c,function(){a(this).trigger(f.HIDE)}))},this.setTitle=function(b){a(i).text(b)},this.getContainer=function(){return g},this.getMask=function(){return d.getElement()},this.getContent=function(){return l},this.getTextContainer=function(){return m},this.getBottom=function(){return n},this.setConfirmText=function(b){a(m).text(b)},this.setConfirmHtml=function(b){a(m).html(b)},this.setMessageText=function(a){c.setConfirmText(a)},this.setMessageHtml=function(a){c.setConfirmHtml(a)},o(),this.getManager=function(){return d},d.setPosition(this)},ButtonFactory:function(b){var c=document.createElement(a.Dlg.CONST.HTML_A),d=document.createElement(a.Dlg.CONST.HTML_A),e=document.createElement(a.Dlg.CONST.HTML_A),f=document.createElement(a.Dlg.CONST.HTML_A),g=document.createElement(a.Dlg.CONST.HTML_A);c.href=a.Dlg.CONST.VOID_LINK,a(c).addClass(a.Dlg.CONST.CSS_BTNSMALL).attr("title",b.yesButtonText).append(a(document.createElement(a.Dlg.CONST.HTML_SPAN)).text(b.yesButtonText)).click(b.yesButtonEvent),d.href=a.Dlg.CONST.VOID_LINK,a(d).addClass(a.Dlg.CONST.CSS_BTNSMALL).attr("title",b.noButtonText).append(a(document.createElement(a.Dlg.CONST.HTML_SPAN)).text(b.noButtonText)).click(b.noButtonEvent),e.href=a.Dlg.CONST.VOID_LINK,a(e).addClass(a.Dlg.CONST.CSS_BTNSMALL+" mr10").attr("title",b.okButtonText).append(a(document.createElement(a.Dlg.CONST.HTML_SPAN)).text(b.okButtonText)).click(b.okButtonEvent),f.href=a.Dlg.CONST.VOID_LINK,a(f).addClass(a.Dlg.CONST.CSS_BTNSMALL+" mr10").attr("title",b.saveButtonText).append(a(document.createElement(a.Dlg.CONST.HTML_SPAN)).text(b.saveButtonText)).click(b.saveButtonEvent),g.href=a.Dlg.CONST.VOID_LINK,a(g).addClass(a.Dlg.CONST.CSS_BTNSMALL).attr("title",b.cancelButtonText).append(a(document.createElement(a.Dlg.CONST.HTML_SPAN)).text(b.cancelButtonText)).click(b.cancelButtonEvent),this.applyTo=function(h){var i=h.getBottom(),j=function(){h.fadeOut()},k=function(){h.fadeOut(!1)};switch(a(i).empty(),b.buttonType){case a.Dlg.ButtonType.OK:a(i).append(e),a(e).click(j);break;case a.Dlg.ButtonType.YESNO:a(i).append(c).append(d),a(c).click(j),a(d).click(j);break;case a.Dlg.ButtonType.OKCANCEL:a(i).append(e).append(g),a(e).click(j),a(g).click(k);break;case a.Dlg.ButtonType.SAVECANCEL:a(i).append(f).append(g),a(f).click(function(){if(b.saveCallback&&a.isFunction(b.saveCallback)){var c=b.saveCallback(h);c&&j()}else j()}),a(g).click(k)}}},WarningDialog:function(b){var c=new a.Dlg.DialogManager(b),d=document.createElement(a.Dlg.CONST.HTML_DIV),e=document.createElement(a.Dlg.CONST.HTML_DIV),f=document.createElement(a.Dlg.CONST.HTML_DIV),g=document.createElement(a.Dlg.CONST.HTML_DIV),h=document.createElement(a.Dlg.CONST.HTML_SPAN);a(d).addClass(a.Dlg.CONST.CSS_DLG).css({position:"absolute",zIndex:b.dialogZIndex}),a(e).addClass(a.Dlg.CONST.CSS_HEADER_SIMPLE),a(f).addClass(a.Dlg.CONST.CSS_CONT),a(g).addClass(a.Dlg.CONST.CSS_CONTENT),a(h).addClass(a.Dlg._get_warning_class(b.warningType)).text(b.warningText),a(g).append(h).appendTo(a(f)),a(d).hide().append(f).appendTo(document.body),this.show=function(){c.showMask(),a(d).show()},this.hide=function(b){c.hideMask(),a(d).hide(0,b)},this.fadeOut=function(e,f){c.hideMask(),e=void 0==e?b.fadeSpeed:e,a(d).fadeOut(e,f)},this.getContainer=function(){return d},this.getContent=function(){return g},c.setPosition(this)},paramTypeException:function(a,b,c){this.desc=void 0==c?"":c,this.toString=function(){return this.desc?this.desc:"Type["+b+"] is not supported on parameters["+a+"]"}}}})}(jQuery);