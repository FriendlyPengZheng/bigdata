/*! taomee tongji javascript code by maverick 2015-02-04 */
!function(a){a.fn.slideShow=function(a,b,c,d,e){var f=new Object;return f[a]=0,this.animate(f,c,d,e)},a.fn.slideHide=function(a,b,c,d,e){var f=new Object;return f[a]=-b,this.animate(f,c,d,e)},a.widget("uicart.slidecart",{options:{position:"right",top:0,bottom:0,height:document.body.clientHeight,handlerWidth:35,panelWidth:250,notifyHgt:40,BtnHgt:100,containerPos:null,handlerPos:null,panelPos:null,handlerBackground:"#000000",panelBackground:"#383838",mask:!1,maskZIndex:70,maskOpacity:.5,tags:1,extraInfo:!0,unfold:!1,setCommonTag:function(){return a(this).css({"float":"left",width:35,height:90,backgroundColor:"#27408B",cursor:"pointer"}),a(this)},commonTagEffect:function(){return a(this)},setSingleTag:[function(){a(this).css({backgroundColor:"#FF8C00"})}],setItemsArea:function(){a(this).css({width:240,height:a(window).height()-50,overflowY:"auto",zIndex:73,marginLeft:5,marginTop:50,backgroundColor:"#5E5E5E"})},setSelOpt:function(){a(document.createElement("option")).text("并集运算").attr({type:"union"}).appendTo(a(this)),a(document.createElement("option")).text("交集运算").attr({type:"intersect"}).appendTo(a(this)),a(document.createElement("option")).text("差集运算").attr({type:"setdiff"}).appendTo(a(this))},setUnfold:function(){return a(this)},setFilter:function(){return a(this)},setBtn:function(){return a(this)}},_create:function(){this._setConPos(this.options.position),this.element.css(a.extend({position:"fixed",zIndex:this.options.maskZIndex+1},this.options.containerPos)),this._reSize(this.element),this._setHandler(),this._setPanel();var b=this._addTag(this._cartHandler);this._addHook(b,"click",this.element)},_reSize:function(b){var c=this,d=document.body.clientHeight;a(window).resize(function(){b.css({height:document.body.clientHeight-(d-c.options.height)})})},_setConPos:function(a){switch(a){case"right":this.options.containerPos={top:this.options.top,bottom:this.options.bottom,right:-this.options.panelWidth,width:this.options.handlerWidth+this.options.panelWidth,height:this.options.height},this.options.handlerPos={marginLeft:0,padding:0,width:this.options.handlerWidth,height:this.options.height},this.options.panelPos={margin:0,paddingLeft:this.options.handlerWidth,width:this.options.panelWidth,height:this.options.height};break;case"left":this.options.containerPos={top:this.options.top,bottom:this.options.bottom,left:-this.options.panelWidth,width:this.options.handlerWidth+this.options.panelWidth,height:this.options.height},this.options.handlerPos={marginLeft:this.options.panelWidth,padding:0,width:this.options.handlerWidth,height:this.options.height},this.options.panelPos={margin:0,paddingLeft:this.options.handlerWidth,width:this.options.panelWidth,height:this.options.height};break;default:this.options.containerPos={top:this.options.top,bottom:this.options.bottom,right:-this.options.panelWidth,width:this.options.handlerWidth+this.options.panelWidth,height:this.options.height},this.options.handlerPos={marginLeft:0,padding:0,width:this.options.handlerWidth,height:this.options.height},this.options.panelPos={margin:0,paddingLeft:this.options.handlerWidth,width:this.options.panelWidth,height:this.options.height}}},_setHandler:function(){return this._cartHandler=a("<div></div>").css(a.extend({position:"absolute",zIndex:this.options.maskZIndex+3,background:this.options.handlerBackground},this.options.handlerPos)).addClass("cart-handler").appendTo(this.element),this._reSize(this._cartHandler),this._cartHandler},_setPanel:function(){return this._innerPanel=a("<div></div>").css(a.extend({position:"absolute",zIndex:this.options.maskZIndex+2,background:this.options.panelBackground},this.options.panelPos)).addClass("inner-panel").appendTo(this.element),this._reSize(this._innerPanel),this._setNotifyArea(),this._setItemsArea(),this._setBtnArea(),this._innerPanel},_setNotifyArea:function(){return this._notifyArea=this._appendElement("div","notify-area",this._innerPanel),this._notifyArea.css({"float":"left",width:"100%",height:this.options.notifyHgt,backgroundColor:this.options.panelBackground}),this._setNotifyTxt(),this._notifyArea},_setNotifyTxt:function(){return this._notifyTxt=this._appendElement("div","notify-txt",this._notifyArea),this._notifyTxt.css({height:20,width:"80%",marginTop:14,marginLeft:13}),this._notify=this._appendElement("span","notify",this._notifyTxt),this._notify.css({"float":"left",color:"white",fontSize:16}).attr({title:"差集支持最多3个事件的计算,交集和并集支持最多5个事件的计算"}).text("已选0条，共0条"),this._notifyTxt},_setItemsArea:function(){return this.itemArea=this._appendElement("div","item-area",this._innerPanel),this.itemArea.css({"float":"left",width:"100%",height:this.itemArea.parent().height()-this.options.notifyHgt-this.options.BtnHgt}),this._setItemCon(),this.itemArea},_setItemCon:function(){var a=5,b=5;return this._itemCon=this._appendElement("div","item-con",this.itemArea),this._itemCon.css({"float":"left",height:this._itemCon.parent().height()-b,width:this.options.panelWidth-2*a,marginTop:b,marginLeft:a,overflowY:"auto",zIndex:this.options.maskZIndex+3,backgroundColor:"#5E5E5E"}),this.options.setItemsArea.call(this._itemCon),this._itemCon},_setBtnArea:function(){return this.btnArea=this._appendElement("div","btn-area",this._innerPanel),this.btnArea.css({"float":"left",width:"100%",height:this.options.BtnHgt,backgroundColor:"#DCDCDC"}),this._setSubmitCtrl(),this._setFilter(),this._setSubmitBtn(),this.btnArea},_setSubmitCtrl:function(){return this.submitCtrl=this._appendElement("div","submit-ctrl",this.btnArea),this.submitCtrl.css({"float":"left",width:"100%",height:this.options.BtnHgt/2}),this.options.extraInfo&&this._setExtraInfo(),this.submitCtrl},_setExtraInfo:function(){var a=10,b=10;return this.extraInfo=this._appendElement("div","extra-info",this.submitCtrl),this.extraInfo.css({"float":"left",width:this.extraInfo.parent().width()-2*a,marginLeft:a,height:this.options.BtnHgt/2-b}),this._setSelect(),this._setUnfold(),this.extraInfo},_setSelect:function(){return this.selectArea=this._appendElement("div","select-area",this.extraInfo),this.gameSelector=this._appendElement("select","game-selector",this.selectArea),this.calcSelector=this._appendElement("select","calc-selector",this.selectArea),this.calcSelector.css({"float":"left",marginTop:10,boxShadow:"inset 1px 2px 5px 1px #e2e2e2",cursor:"pointer",borderRadius:3,height:30,backgroundColor:"white",width:80}),this.gameSelector.css({"float":"left",marginTop:10,marginRight:8,boxShadow:"inset 1px 2px 5px 1px #e2e2e2",cursor:"pointer",borderRadius:3,height:30,backgroundColor:"white",width:100}).hide(),this.options.setSelOpt.call(this.calcSelector),this.selectArea},_setUnfold:function(){var b=this;return this.unfold=this._appendElement("div","unfold",this.extraInfo),this.unfold.css({"float":"right",marginTop:10,cursor:"pointer",borderRadius:3,height:30,width:90,backgroundColor:"#228b22"}).click(function(){var c=a(this).parent(),d=c.parent().next();$submit=c.parent().next().next(),$btnArea=c.parent().parent(),$itemArea=$btnArea.prev(),b.options.unfold?($itemArea.animate({height:"+=200px"},"fast"),$itemArea.children().animate({height:"+=200px"},"fast"),d.animate({height:"-=200px"},"fast",function(){a(this).hide()}),$btnArea.animate({height:"-=200px"},"fast"),b.options.unfold=!1):($itemArea.animate({height:"-=200px"},"fast"),$itemArea.children().animate({height:"-=200px"},"fast"),d.animate({height:"+=200px"},"fast").show(),$btnArea.animate({height:"+=200px"},"fast"),b.options.unfold=!0)}),this.options.setUnfold.call(this.unfold),this.unfold},_setFilter:function(){return this.filter=this._appendElement("div","filter-info",this.btnArea),this.filter.css({"float":"left",width:"100%",height:0}).hide(),this.options.setFilter.call(this.filter),this.filter},_setSubmitBtn:function(){var a=10,b=10,c=this;return this.submitBtn=this._appendElement("div","submit-btn",this.btnArea),this.submitBtn.css({"float":"left",width:this.submitBtn.parent().width()-2*a,marginLeft:a,height:this.options.BtnHgt/2-b,backgroundColor:"#8B0000",borderRadius:3,cursor:"pointer"}).click(function(){c._trigger("submit")}),this.options.setBtn.call(this.submitBtn),this.submitBtn},_addTag:function(b){for(var c=this,d=0;d<this.options.tags;d++){var e=a(document.createElement("div")).addClass("tag-ins off").appendTo(b).click(function(){a(this).toggleClass("off"),a(this).toggleClass("on"),c._trigger(a(this).hasClass("on")?"refresh":"save")});this.options.setCommonTag.call(e),this.options.commonTagEffect.call(e),null!=this.options.setSingleTag[d]&&this.options.setSingleTag[d].call(e)}return a(".tag-ins")},_addItemsArea:function(b){return this._itemsArea=a("<div></div>").addClass("items-area").appendTo(b),this.options.setItemsArea.call(this._itemsArea),a(".items-area")},_addButton:function(b){var c=140;return this._panelBtn=a("<div></div>").css({"float":"left",height:c,width:this.options.panelWidth,marginLeft:0,marginTop:-c,backgroundColor:"#8B0000",bottom:this.options.bottom,left:0,zIndex:this.options.maskZIndex+100,cursor:"pointer"}).addClass("panel-btn").appendTo(b),a(".panel-btn")},addButton:function(a){this._addButton(a)},_addHook:function(b,c,d){var e=document.createElement("div"),f=this,g=[];a(e).css({position:"fixed",backgroundColor:"black",opacity:this.options.maskOpacity,top:this.options.top,bottom:this.options.bottom,nwidth:a(document).width(),left:0,right:0,zIndex:f.options.maskZIndex}).hide().appendTo(document.body),b.each(function(){a(this).on(c,function(){var b=1==f.options.tags?2:f.options.tags;g.length>b-1&&g.shift(),g.push(this),1===g.length?(f.options.mask&&a(e).css({height:a(document).height()-(f.options.top+f.options.bottom)}).fadeIn("normal"),d.slideShow(f.options.position,f.options.panelWidth,"normal")):g[g.length-1]==g[g.length-2]?(f.options.mask&&a(e).fadeOut("normal"),d.slideHide(f.options.position,f.options.panelWidth,"fast"),g=[]):g[g.length-1]!=g[g.length-2]})})},addHook:function(a,b,c){this._addHook(a,b,c)},_appendElement:function(b,c,d){return a(document.createElement(b)).addClass(c).appendTo(d)},destroy:function(){this._cartHandler.remove(),this._innerPanel.remove(),a.Widget.prototype.destroy.apply(this,arguments)}})}(jQuery);